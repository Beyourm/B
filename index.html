<!doctype html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ููุญุฉ ุชุญูู ุงููุณูููู</title> 

    <meta property="og:title" content="ููุญุฉ ุชุญูู ุงููุณูููู" /> 
    <meta property="og:description" content="ุฑุงุฌุน ุฅุญุตุงุฆูุงุช ุฅุญุงูุชู ุนุจุฑ ุงูุฑุงุจุท ุงูุฎุงุต ุจู." /> 
    <meta property="og:image" content="https://skillia.netlify.app/images/photo.jpg" />
    <meta property="og:url" content="https://sklilia.netlify.app/Trainees_Records" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="ar_AR" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../assets/fonts/tajawal.css">
 <link rel="stylesheet" href="style.css"> 
    <link rel="stylesheet" href="table-styles.css"> 


</head>
<body>

<div class="dashboard-container">
    <header>
        <button id="theme-toggle" class="toggle-btn" title="ุชุจุฏูู ุงููุถุน ุงููููู/ุงูููุงุฑู" onclick="toggleDarkMode()">
             <i class="fas fa-moon"></i>
        </button>
        
        <h1>ููุญุฉ ุชุญูู ุงููุณูููู</h1>
        <p id="marketer-id-display">ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงููุนุฑูู ูู ุงูุฑุงุจุท</p>
        
        <button class="courses-btn" onclick="openCoursesDialog()">
            <i class="fas fa-graduation-cap"></i> ุงูุชุดู ุฏูุฑุงุชูุง ุงูุขู
        </button>
        
    </header>

    <div class="content">
        <div id="statusMessage" class="loading" style="text-align:center;">
            
            <h2 style="color: var(--muted-color); font-size: 16px; font-weight: 700;">
                <span class="spinner"></span> ุฌุงุฑู ุฌูุจ ุงูุจูุงูุงุช ูุชุฌููุฒ ููุญุฉ ุงูุชุญูู...
            </h2>
            
            <div class="stats-grid" style="margin-top: 20px;">
                <div class="stats-card skeleton-card">
                    <div class="skeleton-text skeleton" style="width: 80%;"></div>
                    <div class="skeleton-count skeleton"></div>
                </div>
                <div class="stats-card active-card skeleton-card">
                    <div class="skeleton-text skeleton" style="width: 85%;"></div>
                    <div class="skeleton-count skeleton"></div>
                </div>
                <div class="stats-card balance-card skeleton-card">
                    <div class="skeleton-text skeleton" style="width: 70%;"></div>
                    <div class="skeleton-count skeleton"></div>
                </div>
            </div> 
            
            
            
            <h2 style="color: var(--primary-color); border-bottom: 2px solid var(--secondary-color); padding-bottom: 5px; margin-bottom: 20px;"><i class="fas fa-address-card card-title-icon"></i> ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ</h2>
            <div class="details-card skeleton-card" style="min-height: 150px; padding: 10px;">
                <div class="skeleton-details-item">
                    <div class="skeleton-text skeleton"></div>
                    <div class="skeleton-text skeleton"></div>
                </div>
                 <div class="skeleton-details-item">
                    <div class="skeleton-text skeleton"></div>
                    <div class="skeleton-text skeleton"></div>
                </div>
            </div>
            
        </div>

       
        <div id="dashboardContent" style="display:none;">
            
            <div class="stats-grid">
                <div class="stats-card">
                    <h2><i class="fas fa-users card-title-icon"></i> ุฅุฌูุงูู ุนุฏุฏ ุงููุณุฌูููู ุนุจุฑ ุงูุฑุงุจุท ุงูุฎุงุต ุจู</h2>
                    <span class="stats-count" id="referrals-count">0</span>
                </div>
                <div class="stats-card active-card">
                    <h2><i class="fas fa-check-circle card-title-icon"></i> ุงููุณุฌูููู ุงููุดุทูู (ุงูุญุงูุฉ Y)</h2>
                    <span class="stats-count" id="active-referrals-count">0</span>
                </div>
                <div class="stats-card balance-card">
                    <h2>
                        <i class="fas fa-wallet card-title-icon"></i> ุงูุฑุตูุฏ ุงูุญุงูู
                    </h2>
                    <span class="stats-count" id="current-balance">0</span> <span style="font-weight: 700;">$</span>
                </div>
            </div> <h2 style="color: var(--primary-color); border-bottom: 2px solid var(--secondary-color); padding-bottom: 5px; margin-bottom: 20px;"><i class="fas fa-chart-pie card-title-icon"></i> ุชุญูููุงุช ุงูุฅุญุงูุฉ</h2>
            <div class="chart-container" id="analytics-charts">
                <p style="text-align: center; color: #777;">ุณูุชู ุนุฑุถ ุงูุฑุณูู ุงูุจูุงููุฉ (Charts) ูุซู ูุณุจุฉ ุงููุดุทูู ููุงุจู ุบูุฑ ุงููุดุทูู ููุง. (ูุชุทูุจ Chart.js)</p>
                <canvas id="referral-pie-chart" style="max-height: 250px; margin-top: 15px;"></canvas>
            </div>
       
       
            
            
            <div class="stats-card" style="margin-bottom: 20px;">
                <h2 style="margin-top: 0;"><i class="fas fa-link card-title-icon"></i> ุฑุงุจุท ุงูุฅุญุงูุฉ ุงูุฎุงุต ุจู</h2>
                <div class="referral-link-box" id="referral-link-box" title="ุงุถุบุท ููุณุฎ ุงูุฑุงุจุท">
                    <span id="referral-link-text">...</span>
                    <button class="copy-btn" id="copy-btn"><i class="fas fa-copy"></i> ูุณุฎ</button>
                </div>
                <p style="font-size: 12px; color: #555; margin-top: 10px;">ุงููุฑ ุนูู ุงูุฑุงุจุท ุฃู ุงูุฒุฑ ููุณุฎู ููุดุงุฑูุชู. (ุชู ุชุญุณูู ุฑุณุงูุฉ ุงููุณุฎ)</p>
            </div>

            <h2 style="color: var(--primary-color); border-bottom: 2px solid var(--secondary-color); padding-bottom: 5px; margin-bottom: 20px;"><i class="fas fa-address-card card-title-icon"></i> ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ</h2>
            <div class="details-card" id="personal-details">
                </div>

            <div class="referrals-section">
                <div class="referrals-header">
                    <div class="top-row">
                        <h2 style="margin: 0; color: var(--primary-color); font-size: 18px; font-weight: 700;">ูุงุฆูุฉ ุงููุณุฌูููู ุนุจุฑ ุงูุฑุงุจุท</h2>
                        <button class="download-btn" id="download-btn" style="display:none;">
                            <i class="fas fa-download" style="margin-left: 5px; color: var(--primary-color);"></i>
                            ุชูุฒูู ูููู CSV
                        </button>
                    </div>
                </div>
                
                <div class="filters-bar">
                    <input type="text" id="searchInput" placeholder="๐ ุงุจุญุซ ุจุงูุงุณูุ ุงููุงุชูุ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู..." oninput="filterReferrals()">
                    <select id="statusFilter" onchange="filterReferrals()">
                        <option value="">ูู ุงูุญุงูุงุช</option>
                        <option value="Y">ูุดุท (Y)</option>
                        <option value="N">ุบูุฑ ูุดุท (N)</option>
                        <option value="P">ูุนููู (P)</option>
                    </select>
                    <select id="cityFilter" onchange="filterReferrals()">
                        <option value="">ูู ุงููุฏู</option>
                        </select>
                    <button onclick="applyAdvancedFilter()"><i class="fas fa-filter"></i> ุชุทุจูู ุงูููุงุชุฑ</button>
                </div>

                <div class="cards-container" id="referrals-table-container">
                    </div>
            </div>
            
            <div id="pagination-controls" style="text-align:center; margin-top: 20px; display: none;">
                <button class="copy-btn" disabled>ุงูุณุงุจู</button>
                <span style="margin: 0 10px; font-weight: 700;">ุงูุตูุญุฉ 1 ูู 1</span>
                <button class="copy-btn">ุงูุชุงูู</button>
            </div>
            
            <p style="text-align:center; font-size:12px; color:#888; margin-top: 30px;">ุงูุจูุงูุงุช ูุญุฏุซุฉ ุชููุงุฆููุง ูู ูุธุงู ุงูุชุณุฌูู ุงูุฑุณูู ููุคุณุณุฉ ูู ุฃูุช.</p>

        </div>

    </div>
</div>

<div id="toastNotification" class="toast-notification">
    <i class="fas fa-check-circle"></i> ุชู ูุณุฎ ุงูุฑุงุจุท ุฅูู ุงูุญุงูุธุฉ!
</div>

<div id="coursesModalOverlay" class="modal-overlay">
    <div class="modal-content">
        <button id="closeModalBtn" class="modal-close-btn" title="ุฅุบูุงู ุงููุงูุฐุฉ">&times;</button>
        
        <iframe id="dialogIframe" class="modal-iframe" src="" frameborder="0"></iframe>
    </div>
</div>


<script>
// ุฏุงูุฉ JavaScript ุงููุนุฏูุฉ ููุชุญ ุงููุงูุฐุฉ
function openCoursesDialog() {
    const overlay = document.getElementById('coursesModalOverlay');
    const iframe = document.getElementById('dialogIframe');
    const coursesBtn = document.querySelector('.courses-btn');
    
    // 1. ุนุฑุถ ุญุงูุฉ ุงูุชุญููู (UX Enhancement)
    coursesBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ุฌุงุฑู ุงูุชุญููู...';
    coursesBtn.disabled = true;

    // 2. ุฅุนุฏุงุฏ ูุนุฑุถ ุงููุงูุฐุฉ
    iframe.src = ''; 
    // **ุชุนุฏูู ุญุงุณู: ุฅุถุงูุฉ ุงูููุงุณ ูุนุฑุถ ุงููุงูุฐุฉ**
    overlay.classList.add('is-visible'); 
    
    // ุงูุจุฏุก ุจุชุญููู ุงููุญุชูู
    iframe.src = 'courses.html'; 

    // 3. ุฅุนุงุฏุฉ ุงูุฒุฑ ููุถุนู ุงูุทุจูุนู ุจุนุฏ ุชุญููู ุงููุญุชูู
    iframe.onload = () => {
        coursesBtn.innerHTML = '<i class="fas fa-graduation-cap"></i> ุงูุชุดู ุฏูุฑุงุชูุง ุงูุขู';
        coursesBtn.disabled = false;
    };
    
    iframe.onerror = () => {
        coursesBtn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> ุฎุทุฃ! ุญุงูู ูุฌุฏุฏุงู';
        coursesBtn.disabled = false;
    };
}

// ุฏุงูุฉ ุฌุฏูุฏุฉ ูุฅุบูุงู ุงููุงูุฐุฉ
function closeCoursesDialog() {
    const overlay = document.getElementById('coursesModalOverlay');
    overlay.classList.remove('is-visible');
    // ุฅููุงู ุชุญููู ุงููุญุชูู ุฏุงุฎู ุงูู iframe
    document.getElementById('dialogIframe').src = ''; 
}

// ุฑุจุท ุฒุฑ ุงูุฅุบูุงู ุจุงูุฏุงูุฉ ุงูุฌุฏูุฏุฉ
document.getElementById('closeModalBtn').onclick = closeCoursesDialog;


// ุฏุงูุฉ ููููุฉ ููุชุจุฏูู ุจูู ุงููุถุน ุงููููู ูุงูููุงุฑู (ุชุชุทูุจ ุชูููุฐุงู ูู JS)
function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
    const icon = document.getElementById('theme-toggle').querySelector('i');
    if (document.body.classList.contains('dark-mode')) {
        icon.classList.remove('fa-moon');
        icon.classList.add('fa-sun');
        document.getElementById('theme-toggle').title = 'ุชุจุฏูู ุงููุถุน ุงูููุงุฑู';
    } else {
        icon.classList.remove('fa-sun');
        icon.classList.add('fa-moon');
        document.getElementById('theme-toggle').title = 'ุชุจุฏูู ุงููุถุน ุงููููู';
    }
}

// ุฏุงูุฉ ููููุฉ ูุชุทุจูู ุงูููุชุฑุฉ ุงููุชูุฏูุฉ (ุชุชุทูุจ ุชูููุฐุงู ูู JS)
function applyAdvancedFilter() {
    console.log("Applying advanced filters...");
    // ูุฐุง ูุญุชุงุฌ ููุทู ูู ูููุงุช JS ุงูุฎุงุฑุฌูุฉ
}

// ุฏุงูุฉ ุงูุชุฑุงุถูุฉ ููุฌูุฏุฉ ูู ุงูููุฏ ุงูุฃุตูู
function filterReferrals() {
    console.log("Filtering referrals...");
    // ูุฐุง ูุญุชุงุฌ ููุทู ูู ูููุงุช JS ุงูุฎุงุฑุฌูุฉ
}


// ุฏุงูุฉ ุชููุฆุฉ ูุฎุทุท ุจูุงูู ูููู (Placeholder Chart)
function initPlaceholderChart() {
    const ctx = document.getElementById('referral-pie-chart');
    
    // ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงูุนูุตุฑ
    if (!ctx) return; 

    // ุฅุฒุงูุฉ ุฑุณุงูุฉ ุงูู Placeholder ุจูุฌุฑุฏ ุชููุฆุฉ ุงููุฎุทุท
    const placeholderMessage = document.querySelector('#analytics-charts p');
    if (placeholderMessage) {
        placeholderMessage.style.display = 'none';
    }

    // ุจูุงูุงุช ููููุฉ (Dummy Data) ูุถูุงู ุธููุฑ ุงููุฎุทุท
    const dummyData = {
        labels: ['ูุณุฌููู ูุดุทูู (Y)', 'ูุณุฌููู ุบูุฑ ูุดุทูู/ูุนูููู (N/P)'],
        datasets: [{
            data: [5, 2], // 5 ูุดุทูู ู 2 ุบูุฑ ูุดุทูู ููุซุงู
            backgroundColor: [
                '#0d3b14', // ุงูููู ุงูุฃุฎุถุฑ (Primary)
                '#e5a72d'  // ุงูููู ุงูุฐูุจู (Secondary)
            ],
            hoverOffset: 10
        }]
    };

    // ุชููุฆุฉ ุงููุฎุทุท (ูุชุทูุจ Chart.js)
    try {
        // ุชุฃูุฏ ูู ุชุญููู Chart
        if (typeof Chart !== 'undefined') {
            new Chart(ctx, {
                type: 'doughnut', 
                data: dummyData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Tajawal',
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });
        }
    } catch (e) {
        console.error("Error initializing Chart:", e);
    }
}


// ุฅุฒุงูุฉ ูุญุชูู window.onload ุงูุฃุตูู ุงูุฐู ูุชุนุงุฑุถ ูุน ููู dashboard.js
// ุณุชุชู ุฅุฏุงุฑุฉ ุงูุชููุฆุฉ ุจูุงุณุทุฉ dashboard.js ุงูุขู.

</script>

<script src="marketer_tracker.js"></script> 
<script src="table-logic.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 

<script type="module" src="balance_logic.js"></script> 
<script type="module" src="dashboard.js"></script> 

</body>
</html>
